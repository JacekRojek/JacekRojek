<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <title>Unity EventManager</title>
  <meta name="description" content="Software development blog">
  <meta name="author" content="Jacek Rojek">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Jacek  Rojek">
  <meta name="twitter:description" content="Software development blog">

  <meta property="og:type" content="article">
  <meta property="og:title" content="Jacek  Rojek">
  <meta property="og:description" content="Software development blog">

  <link rel="apple-touch-icon" sizes="57x57" href="/JacekRojek/images/favicons/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/JacekRojek/images/favicons/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/JacekRojek/images/favicons/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/JacekRojek/images/favicons/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/JacekRojek/images/favicons/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/JacekRojek/images/favicons/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/JacekRojek/images/favicons/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/JacekRojek/images/favicons/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/JacekRojek/images/favicons/apple-touch-icon-180x180.png">
  <link rel="icon" type="image/png" href="/JacekRojek/images/favicons/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="/JacekRojek/images/favicons/favicon-194x194.png" sizes="194x194">
  <link rel="icon" type="image/png" href="/JacekRojek/images/favicons/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="/JacekRojek/images/favicons/android-chrome-192x192.png" sizes="192x192">
  <link rel="icon" type="image/png" href="/JacekRojek/images/favicons/favicon-16x16.png" sizes="16x16">
  <link rel="manifest" href="/JacekRojek/images/favicons/manifest.json">
  <link rel="shortcut icon" href="/JacekRojek/images/favicons/favicon.ico">
  <meta name="msapplication-TileColor" content="#ffc40d">
  <meta name="msapplication-TileImage" content="/JacekRojek/images/favicons/mstile-144x144.png">
  <meta name="theme-color" content="#ffffff">

  <link rel="stylesheet" href="/JacekRojek/css/main.css">
  <link rel="canonical" href="https://jacekrojek.github.io/JacekRojek//JacekRojek//2016/unity-eventmanager/">
  <link rel="alternate" type="application/rss+xml" title="Jacek  Rojek" href="/JacekRojek/feed.xml">
</head>


  <body>
    <span class="mobile btn-mobile-menu">
  <i class="icon icon-list btn-mobile-menu__icon"></i>
  <i class="icon icon-x-circle btn-mobile-close__icon hidden"></i>
</span>
  
<header class="panel-cover" style="background-image: url(/JacekRojek/images/cover.jpg)">
  <div class="panel-main">

    <div class="panel-main__inner panel-inverted">
    <div class="panel-main__content">
        <a href="/JacekRojek/" title="link to home of Jacek  Rojek">
          <img src="/JacekRojek/images/profile.jpg" class="user-image" alt="My Profile Photo">
          <h1 class="panel-cover__title panel-title">Jacek  Rojek</h1>
        </a>
        <hr class="panel-cover__divider">
        <p class="panel-cover__description">Software development blog</p>
        <hr class="panel-cover__divider panel-cover__divider--secondary">

        <div class="navigation-wrapper">

          <nav class="cover-navigation cover-navigation--primary">
            <ul class="navigation">
              <li class="navigation__item"><a href="/JacekRojek/#blog" title="link to Jacek  Rojek blog" class="blog-button">Blog</a></li>
            </ul>
          </nav>

          <nav class="cover-navigation navigation--social">
            <ul class="navigation">
          
            
              <!-- Twitter -->
              <li class="navigation__item">
                <a href="http://twitter.com/JRojek93" title="@JRojek93 on Twitter" target="_blank">
                  <i class="icon icon-social-twitter"></i>
                  <span class="label">Twitter</span>
                </a>
              </li>
            

            
              <!-- Facebook -->
              <li class="navigation__item">
                <a href="http://fb.me/jacek.rojek.7" title="jacek.rojek.7 on Facebook" target="_blank">
                  <i class="icon icon-social-facebook"></i>
                  <span class="label">Facebook</span>
                </a>
              </li>
            

            
              <!-- LinkedIn -->
              <li class="navigation__item">
                <a href="https://www.linkedin.com/in/jacek-rojek-b7a396105" title="jacek-rojek-b7a396105 on LinkedIn" target="_blank">
                  <i class="icon icon-social-linkedin"></i>
                  <span class="label">LinkedIn</span>
                </a>
              </li>
            

            
              <!-- GitHub -->
              <li class="navigation__item">
                <a href="https://www.github.com/JacekRojek" title="JacekRojek on GitHub" target="_blank">
                  <i class="icon icon-social-github"></i>
                  <span class="label">GitHub</span>
                </a>
              </li>
            

            
              <!-- Email -->
              <li class="navigation__item">
                <a href="mailto:j.rojek19@gmail.com" title="Email j.rojek19@gmail.com" target="_blank">
                  <i class="icon icon-mail"></i>
                  <span class="label">Email</span>
                </a>
              </li>
            

            <!-- RSS -->
            <li class="navigation__item">
              <a href="/JacekRojek/feed.xml" title="Subscribe" target="_blank">
                <i class="icon icon-rss"></i>
                <span class="label">RSS</span>
              </a>
            </li>
          
            </ul>
          </nav>

        </div>

      </div>

    </div>

    <div class="panel-cover--overlay"></div>
  </div>
</header>


    <div class="content-wrapper">
      <div class="content-wrapper__inner">
        <article class="post-container post-container--single">
  <header class="post-header">
    <div class="post-meta">
      <time datetime="7 Jun 2016" class="post-meta__date date">7 Jun 2016</time> &#8226; <span class="post-meta__tags">on </span>
    </div>
    <h1 class="post-title">Unity EventManager</h1>
  </header>

  <section class="post">
    <p>This is one of the most useful concepts I use in my games. It’s good to implement it in early stage of prototyping. It will make your code look cleaner and increase the performance of the project. I encourage you to read the posts about <a href="https://indiedevart.wordpress.com/2016/05/15/events/">events</a> and <a href="https://indiedevart.wordpress.com/2016/05/29/c-dictionary/">dictionary </a>before moving to this topic, if you are not familiar with those concepts it may be confusing for you.</p>

<p>This event system will be responsible for sending messages between Objects, scripts. We will use Dictionary to store UnityEvents and names of the events.</p>

<div class="language-c# highlighter-rouge"><pre class="highlight"><code><span class="k">private</span> <span class="n">Dictionary</span> <span class="p">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="kt">string</span><span class="p">,</span> <span class="n">UnityEvent</span><span class="p">&amp;</span><span class="n">gt</span><span class="p">;</span> <span class="n">eventDictionary</span><span class="p">;</span>
</code></pre>
</div>

<p>Here is the code attached to the new Empty Game object. It’s responsible for transferring massages between objects. Both Subscriber and Trigger  will refer to instance of this class. In my example this will be the same object, image on the canvas.
~~~ c#<br />
using UnityEngine;
using UnityEngine.Events;
using System.Collections;
using System.Collections.Generic;</p>

<p>public class EventSystemTest : MonoBehaviour
{</p>

<p>private Dictionary&lt;string, UnityEvent&gt; eventDictionary;</p>

<p>private static EventSystemTest eventManager;</p>

<p>public static EventSystemTest instance
 {
 get
 {
 if (!eventManager)
 {
 eventManager = FindObjectOfType(typeof(EventSystemTest)) as EventSystemTest;
 eventManager.Init();
 }
 return eventManager;
 }
 }</p>

<p>void Init()
 {
 eventDictionary = new Dictionary&lt;string, UnityEvent&gt;();
 }</p>

<p>public static void StartListening(string eventName, UnityAction listener)
 {
//We need to crate place in memory for reference to the object 
 UnityEvent thisEvent = null;
 if (instance.eventDictionary.TryGetValue(eventName, out thisEvent))
 {
 thisEvent.AddListener(listener);
 }
 else
 {
//If there is no event with this name add new one to dictionary.
 thisEvent = new UnityEvent();
 thisEvent.AddListener(listener);
 instance.eventDictionary.Add(eventName, thisEvent);
 }
 }</p>

<p>public static void StopListening(string eventName, UnityAction listener)
 {
 UnityEvent thisEvent = null;
 if (instance.eventDictionary.TryGetValue(eventName, out thisEvent))
 {
 thisEvent.RemoveListener(listener);
 }
 }</p>

<p>public static void TriggerEvent(string eventName)
 {
 UnityEvent thisEvent = null;
 if (instance.eventDictionary.TryGetValue(eventName, out thisEvent))
 {
 thisEvent.Invoke();
 }
 }
}
~~~  <br />
Way of getting instance of the this class by other objects is similar to Singleton pattern. There is only one instance of this class in the game scene. In this example I have only one scene so I’m not doing check conditions, to simplify the code.</p>

<p> </p>

<p> 
~~~ c#<br />
using UnityEngine;
using System.Collections;
using UnityEngine.UI;
public class EventSubscriber : MonoBehaviour
{
 void OnEnable()
 {
 EventSystemTest.StartListening("test", SubscribedAction);
 }</p>

<p>void OnDisable()
 {
 EventSystemTest.StopListening("test", SubscribedAction);
 }
 void SubscribedAction()
 {
 Color color = new Vector4(Random.Range(0f, 1f), Random.Range(0f, 1f), Random.Range(0f, 1f),1f);
 this.GetComponent&lt;Image&gt;().color = color;
 }
 void Updade()
 {
 if (Input.GetKeyDown(KeyCode.Space))
 EventSystemTest.TriggerEvent("test");</p>

<p>}
}
~~~  <br />
This script is attached to an Image on the scene.  We subscribe to the Action when script is enabled, at the beginning of the game. And we need to unsubscribe the event to optimize performance of the program. To trigger an event we need just one  line of code and  EventManager is doing for us everything  in the background.</p>

<p>This way even very complex relations between objects can be simplified to just few lines. We can subscribe more than one method, in different parts of game. In my example I’m triggering the event from he same script but it can be called from any other script. I’ll describe more practical use of it in next post. For more informations on this topic visit <a href="https://unity3d.com/learn/tutorials/topics/scripting/events-creating-simple-messaging-system">UnitySite</a>.  Stay Awesome!</p>

<p> </p>

  </section>
  
  <script>

</script>

</article>



      </div>

      <footer class="footer">
  <span class="footer__copyright">&copy; 2016 Jacek Rojek. All rights reserved.</span>
</footer> 

<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script type="text/javascript" src="/JacekRojek/js/main.js"></script>

    </div>
  </body>
</html>