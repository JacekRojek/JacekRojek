<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <title>C# Closures</title>
  <meta name="description" content="Software development blog">
  <meta name="author" content="Jacek Rojek">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Jacek  Rojek">
  <meta name="twitter:description" content="Software development blog">

  <meta property="og:type" content="article">
  <meta property="og:title" content="Jacek  Rojek">
  <meta property="og:description" content="Software development blog">

  <link rel="apple-touch-icon" sizes="57x57" href="/JacekRojek/images/favicons/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/JacekRojek/images/favicons/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/JacekRojek/images/favicons/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/JacekRojek/images/favicons/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/JacekRojek/images/favicons/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/JacekRojek/images/favicons/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/JacekRojek/images/favicons/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/JacekRojek/images/favicons/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/JacekRojek/images/favicons/apple-touch-icon-180x180.png">
  <link rel="icon" type="image/png" href="/JacekRojek/images/favicons/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="/JacekRojek/images/favicons/favicon-194x194.png" sizes="194x194">
  <link rel="icon" type="image/png" href="/JacekRojek/images/favicons/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="/JacekRojek/images/favicons/android-chrome-192x192.png" sizes="192x192">
  <link rel="icon" type="image/png" href="/JacekRojek/images/favicons/favicon-16x16.png" sizes="16x16">
  <link rel="manifest" href="/JacekRojek/images/favicons/manifest.json">
  <link rel="shortcut icon" href="/JacekRojek/images/favicons/favicon.ico">
  <meta name="msapplication-TileColor" content="#ffc40d">
  <meta name="msapplication-TileImage" content="/JacekRojek/images/favicons/mstile-144x144.png">
  <meta name="theme-color" content="#ffffff">

  <link rel="stylesheet" href="/JacekRojek/css/main.css">
  <link rel="canonical" href="https://jacekrojek.github.io/JacekRojek//JacekRojek//2016/c-closures/">
  <link rel="alternate" type="application/rss+xml" title="Jacek  Rojek" href="/JacekRojek/feed.xml">
</head>


  <body>
    <span class="mobile btn-mobile-menu">
  <i class="icon icon-list btn-mobile-menu__icon"></i>
  <i class="icon icon-x-circle btn-mobile-close__icon hidden"></i>
</span>
  
<header class="panel-cover" style="background-image: url(/JacekRojek/images/cover.jpg)">
  <div class="panel-main">

    <div class="panel-main__inner panel-inverted">
    <div class="panel-main__content">
        <a href="/JacekRojek/" title="link to home of Jacek  Rojek">
          <img src="/JacekRojek/images/profile.jpg" class="user-image" alt="My Profile Photo">
          <h1 class="panel-cover__title panel-title">Jacek  Rojek</h1>
        </a>
        <hr class="panel-cover__divider">
        <p class="panel-cover__description">Software development blog</p>
        <hr class="panel-cover__divider panel-cover__divider--secondary">

        <div class="navigation-wrapper">

          <nav class="cover-navigation cover-navigation--primary">
            <ul class="navigation">
              <li class="navigation__item"><a href="/JacekRojek/#blog" title="link to Jacek  Rojek blog" class="blog-button">Blog</a></li>
            </ul>
          </nav>

          <nav class="cover-navigation navigation--social">
            <ul class="navigation">
          
            
              <!-- Twitter -->
              <li class="navigation__item">
                <a href="http://twitter.com/JRojek93" title="@JRojek93 on Twitter" target="_blank">
                  <i class="icon icon-social-twitter"></i>
                  <span class="label">Twitter</span>
                </a>
              </li>
            

            
              <!-- Facebook -->
              <li class="navigation__item">
                <a href="http://fb.me/jacek.rojek.7" title="jacek.rojek.7 on Facebook" target="_blank">
                  <i class="icon icon-social-facebook"></i>
                  <span class="label">Facebook</span>
                </a>
              </li>
            

            
              <!-- LinkedIn -->
              <li class="navigation__item">
                <a href="https://www.linkedin.com/in/jacek-rojek-b7a396105" title="jacek-rojek-b7a396105 on LinkedIn" target="_blank">
                  <i class="icon icon-social-linkedin"></i>
                  <span class="label">LinkedIn</span>
                </a>
              </li>
            

            
              <!-- GitHub -->
              <li class="navigation__item">
                <a href="https://www.github.com/JacekRojek" title="JacekRojek on GitHub" target="_blank">
                  <i class="icon icon-social-github"></i>
                  <span class="label">GitHub</span>
                </a>
              </li>
            

            
              <!-- Email -->
              <li class="navigation__item">
                <a href="mailto:j.rojek19@gmail.com" title="Email j.rojek19@gmail.com" target="_blank">
                  <i class="icon icon-mail"></i>
                  <span class="label">Email</span>
                </a>
              </li>
            

            <!-- RSS -->
            <li class="navigation__item">
              <a href="/JacekRojek/feed.xml" title="Subscribe" target="_blank">
                <i class="icon icon-rss"></i>
                <span class="label">RSS</span>
              </a>
            </li>
          
            </ul>
          </nav>

        </div>

      </div>

    </div>

    <div class="panel-cover--overlay"></div>
  </div>
</header>


    <div class="content-wrapper">
      <div class="content-wrapper__inner">
        <article class="post-container post-container--single">
  <header class="post-header">
    <div class="post-meta">
      <time datetime="13 Jun 2016" class="post-meta__date date">13 Jun 2016</time> &#8226; <span class="post-meta__tags">on </span>
    </div>
    <h1 class="post-title">C# Closures</h1>
  </header>

  <section class="post">
    <p>Closures  allows to use variables from outside the scope of action and store values of the variables in memory in order to reuse them later.  A closure in C# takes the form of an in-line delegate. You can find more about lambda expressions in my post about it <a href="https://indiedevart.wordpress.com/2016/05/25/lambda-expressions/">here</a>.  A closure is attached to its parent method meaning that variables defined in parent’s method body can be referenced from within the anonymous method. It will make more sense after analysing the example.</p>

<p>In this post I’ll be using <a href="https://indiedevart.wordpress.com/2016/05/30/c-action-delegate/">Action delegate</a>, if you are not familiar with the concept of <a href="https://indiedevart.wordpress.com/2016/05/15/delegates/">delegates</a> and<a href="https://indiedevart.wordpress.com/2016/05/15/events/"> events</a>. Click on the links. If you know the basics let’s move on.</p>

<p> </p>

<p>To demonstrate this concept I’ll be using slightly modified example given by <a href="https://www.youtube.com/watch?v=gBO_4BMbsO8">Jamie King </a></p>

<div class="language-c# highlighter-rouge"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Program</span>
<span class="p">{</span>
  <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
  <span class="p">{</span>
     <span class="n">Action</span> <span class="n">a</span> <span class="p">=</span> <span class="nf">MyAction</span><span class="p">();</span>
     <span class="n">Action</span> <span class="n">b</span> <span class="p">=</span> <span class="nf">MyAction</span><span class="p">();</span>
     <span class="nf">a</span><span class="p">();</span> <span class="nf">a</span><span class="p">();</span> <span class="nf">a</span><span class="p">();</span>
     <span class="nf">b</span><span class="p">();</span> <span class="nf">b</span><span class="p">();</span>

     <span class="n">Console</span><span class="p">.</span><span class="nf">ReadLine</span><span class="p">();</span>
<span class="c1">//Output will be 
// 1 2 3
// 1 2
</span>  <span class="p">}</span>
  <span class="k">static</span> <span class="n">Action</span> <span class="nf">MyAction</span><span class="p">()</span>
  <span class="p">{</span>
     <span class="n">Action</span> <span class="n">ret</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
    <span class="n">ret</span> <span class="p">+=</span> <span class="p">()</span> <span class="p">=&amp;</span><span class="n">gt</span><span class="p">;</span>
    <span class="p">{</span>
       <span class="n">i</span><span class="p">++;</span>
    <span class="p">};</span>
    <span class="n">ret</span> <span class="p">+=</span> <span class="p">()</span> <span class="p">=&amp;</span><span class="n">gt</span><span class="p">;;</span>
    <span class="p">{</span>
       <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">Action</span> <span class="n">i</span><span class="p">=</span> <span class="p">&amp;</span><span class="n">quot</span><span class="p">;</span> <span class="p">+</span><span class="n">i</span><span class="p">);</span>
    <span class="p">};</span>
    <span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>
<p>This is great way of demonstrating how closures works. We create a static method that contains int i, and returns an action. To demonstrate and example of chaining i created two lambda expressions, one for incrementing the i value and one for printing the variable. This method is called multiple times inside the main method.</p>

<p>Two different actions can refer to the same i variable and have different outcomes. It’s because each time we create new action and we call this method C# is creating a class in the background, class that stores the values that is using. This way we can refer to the value from the original scope and with new copies of action we have different values. This is syntax sugar added in later version of C#. This was just vary simple illustration of the concept of courses. In the next post I’ll cover more practical, real word examples. Stay Awesome!</p>

<p> </p>

  </section>
  
  <script>

</script>

</article>



      </div>

      <footer class="footer">
  <span class="footer__copyright">&copy; 2016 Jacek Rojek. All rights reserved.</span>
</footer> 

<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script type="text/javascript" src="/JacekRojek/js/main.js"></script>

    </div>
  </body>
</html>