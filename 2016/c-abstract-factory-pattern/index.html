<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <title>C# Abstract Factory Pattern</title>
  <meta name="description" content="Software development blog">
  <meta name="author" content="Jacek Rojek">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Jacek  Rojek">
  <meta name="twitter:description" content="Software development blog">

  <meta property="og:type" content="article">
  <meta property="og:title" content="Jacek  Rojek">
  <meta property="og:description" content="Software development blog">

  <link rel="apple-touch-icon" sizes="57x57" href="/JacekRojek/images/favicons/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/JacekRojek/images/favicons/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/JacekRojek/images/favicons/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/JacekRojek/images/favicons/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/JacekRojek/images/favicons/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/JacekRojek/images/favicons/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/JacekRojek/images/favicons/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/JacekRojek/images/favicons/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/JacekRojek/images/favicons/apple-touch-icon-180x180.png">
  <link rel="icon" type="image/png" href="/JacekRojek/images/favicons/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="/JacekRojek/images/favicons/favicon-194x194.png" sizes="194x194">
  <link rel="icon" type="image/png" href="/JacekRojek/images/favicons/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="/JacekRojek/images/favicons/android-chrome-192x192.png" sizes="192x192">
  <link rel="icon" type="image/png" href="/JacekRojek/images/favicons/favicon-16x16.png" sizes="16x16">
  <link rel="manifest" href="/JacekRojek/images/favicons/manifest.json">
  <link rel="shortcut icon" href="/JacekRojek/images/favicons/favicon.ico">
  <meta name="msapplication-TileColor" content="#ffc40d">
  <meta name="msapplication-TileImage" content="/JacekRojek/images/favicons/mstile-144x144.png">
  <meta name="theme-color" content="#ffffff">

  <link rel="stylesheet" href="/JacekRojek/css/main.css">
  <link rel="canonical" href="https://jacekrojek.github.io/JacekRojek//JacekRojek//2016/c-abstract-factory-pattern/">
  <link rel="alternate" type="application/rss+xml" title="Jacek  Rojek" href="/JacekRojek/feed.xml">
</head>


  <body>
    <span class="mobile btn-mobile-menu">
  <i class="icon icon-list btn-mobile-menu__icon"></i>
  <i class="icon icon-x-circle btn-mobile-close__icon hidden"></i>
</span>
  
<header class="panel-cover" style="background-image: url(/JacekRojek/images/cover.jpg)">
  <div class="panel-main">

    <div class="panel-main__inner panel-inverted">
    <div class="panel-main__content">
        <a href="/JacekRojek/" title="link to home of Jacek  Rojek">
          <img src="/JacekRojek/images/profile.jpg" class="user-image" alt="My Profile Photo">
          <h1 class="panel-cover__title panel-title">Jacek  Rojek</h1>
        </a>
        <hr class="panel-cover__divider">
        <p class="panel-cover__description">Software development blog</p>
        <hr class="panel-cover__divider panel-cover__divider--secondary">

        <div class="navigation-wrapper">

          <nav class="cover-navigation cover-navigation--primary">
            <ul class="navigation">
              <li class="navigation__item"><a href="/JacekRojek/#blog" title="link to Jacek  Rojek blog" class="blog-button">Blog</a></li>
            </ul>
          </nav>

          <nav class="cover-navigation navigation--social">
            <ul class="navigation">
          
            
              <!-- Twitter -->
              <li class="navigation__item">
                <a href="http://twitter.com/JRojek93" title="@JRojek93 on Twitter" target="_blank">
                  <i class="icon icon-social-twitter"></i>
                  <span class="label">Twitter</span>
                </a>
              </li>
            

            
              <!-- Facebook -->
              <li class="navigation__item">
                <a href="http://fb.me/jacek.rojek.7" title="jacek.rojek.7 on Facebook" target="_blank">
                  <i class="icon icon-social-facebook"></i>
                  <span class="label">Facebook</span>
                </a>
              </li>
            

            
              <!-- LinkedIn -->
              <li class="navigation__item">
                <a href="https://www.linkedin.com/in/jacek-rojek-b7a396105" title="jacek-rojek-b7a396105 on LinkedIn" target="_blank">
                  <i class="icon icon-social-linkedin"></i>
                  <span class="label">LinkedIn</span>
                </a>
              </li>
            

            
              <!-- GitHub -->
              <li class="navigation__item">
                <a href="https://www.github.com/JacekRojek" title="JacekRojek on GitHub" target="_blank">
                  <i class="icon icon-social-github"></i>
                  <span class="label">GitHub</span>
                </a>
              </li>
            

            
              <!-- Email -->
              <li class="navigation__item">
                <a href="mailto:j.rojek19@gmail.com" title="Email j.rojek19@gmail.com" target="_blank">
                  <i class="icon icon-mail"></i>
                  <span class="label">Email</span>
                </a>
              </li>
            

            <!-- RSS -->
            <li class="navigation__item">
              <a href="/JacekRojek/feed.xml" title="Subscribe" target="_blank">
                <i class="icon icon-rss"></i>
                <span class="label">RSS</span>
              </a>
            </li>
          
            </ul>
          </nav>

        </div>

      </div>

    </div>

    <div class="panel-cover--overlay"></div>
  </div>
</header>


    <div class="content-wrapper">
      <div class="content-wrapper__inner">
        <article class="post-container post-container--single">
  <header class="post-header">
    <div class="post-meta">
      <time datetime="28 Jun 2016" class="post-meta__date date">28 Jun 2016</time> &#8226; <span class="post-meta__tags">on </span>
    </div>
    <h1 class="post-title">C# Abstract Factory Pattern</h1>
  </header>

  <section class="post">
    <p><a href="http://pastebin.com/StPLETej">Link To source Code</a></p>

<p>In previous post i introduced you to the concept of <a href="https://indiedevart.wordpress.com/2016/06/23/c-factory-pattern/">Factory Method</a>. Abstract factory is very similar, but this time we will encapsulate all classes, by cremating interfaces for  Product and Factory. This pattern is also called as Factory of factories, because this patterns acts a superFactory which creates other factories. Abstract factory pattern in useful when the client needs to create objects which are somehow related, without specifying the concrete class.  With this pattern objects can interact with each other through common interfaces.</p>

<p>As usual I am using example from game development. In my example I’ll create Abstract Factory that will spawn enemies and give them specific weapon and armor.</p>
<h3>UML diagram</h3>
<p><img class="alignnone size-full wp-image-3475" src="https://indiedevart.files.wordpress.com/2016/06/l9.png" alt="l9" width="987" height="605" /></p>

<p> </p>
<h2>Factory</h2>
<p>First thing to crate is the interface for Factory, that will be used to specify the equipment of each enemy.</p>

<div class="language-c# highlighter-rouge"><pre class="highlight"><code>
 <span class="k">interface</span> <span class="n">IEnemyFactory</span>
    <span class="p">{</span>
       <span class="n">IWeapon</span> <span class="nf">GetWeapon</span><span class="p">();</span>
       <span class="n">IArmor</span> <span class="nf">GetArmor</span><span class="p">();</span>
    <span class="p">}</span>

</code></pre>
</div>

<p>Concrete classes will be named as the type of enemy that will be created. In my Example i have two enemies Mage and Warrior.</p>

<div class="language-c# highlighter-rouge"><pre class="highlight"><code>
<span class="k">class</span> <span class="nc">Mage</span> <span class="p">:</span> <span class="n">IEnemyFactory</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="n">IWeapon</span> <span class="nf">GetWeapon</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">Wand</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="n">IArmor</span> <span class="nf">GetArmor</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">Cloak</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">class</span> <span class="nc">Warrior</span> <span class="p">:</span> <span class="n">IEnemyFactory</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="n">IWeapon</span> <span class="nf">GetWeapon</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">Sword</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="n">IArmor</span> <span class="nf">GetArmor</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">BodyArmor</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>

</code></pre>
</div>
<h2>Product</h2>
<p>In next step we will create interface for items that will be given to the enemies. Both types share the same types of equipment, weapon and armor.</p>

<div class="language-c# highlighter-rouge"><pre class="highlight"><code>
<span class="k">interface</span> <span class="n">IWeapon</span>
 <span class="p">{</span>
     <span class="kt">string</span> <span class="nf">Item</span><span class="p">();</span>
 <span class="p">}</span>
<span class="k">interface</span> <span class="n">IArmor</span>
 <span class="p">{</span>
     <span class="kt">string</span> <span class="nf">Item</span><span class="p">();</span>
 <span class="p">}</span>

</code></pre>
</div>

<p>In Concrete classes methods will return string values that will be printed to the console.</p>

<div class="language-c# highlighter-rouge"><pre class="highlight"><code>
<span class="k">class</span> <span class="nc">Sword</span> <span class="p">:</span> <span class="n">IWeapon</span>
 <span class="p">{</span>
     <span class="k">public</span> <span class="kt">string</span> <span class="nf">Item</span><span class="p">()</span>
     <span class="p">{</span>
         <span class="k">return</span> <span class="p">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">Iron</span> <span class="n">Sword</span><span class="p">&amp;</span><span class="n">quot</span><span class="p">;;</span>
     <span class="p">}</span>
 <span class="p">}</span>

<span class="k">class</span> <span class="nc">Wand</span> <span class="p">:</span> <span class="n">IWeapon</span>
 <span class="p">{</span>
     <span class="k">public</span> <span class="kt">string</span> <span class="nf">Item</span><span class="p">()</span>
     <span class="p">{</span>
          <span class="k">return</span> <span class="p">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">Magic</span> <span class="n">Wand</span><span class="p">&amp;</span><span class="n">quot</span><span class="p">;;</span>
     <span class="p">}</span>
 <span class="p">}</span>
 <span class="k">class</span> <span class="nc">BodyArmor</span> <span class="p">:</span> <span class="n">IArmor</span>
 <span class="p">{</span>
      <span class="k">public</span> <span class="kt">string</span> <span class="nf">Item</span><span class="p">()</span>
      <span class="p">{</span>
          <span class="k">return</span> <span class="p">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">Iron</span> <span class="n">Body</span> <span class="n">Armor</span><span class="p">&amp;</span><span class="n">quot</span><span class="p">;;</span>
      <span class="p">}</span>
 <span class="p">}</span>

<span class="k">class</span> <span class="nc">Cloak</span> <span class="p">:</span> <span class="n">IArmor</span>
 <span class="p">{</span>
     <span class="k">public</span> <span class="kt">string</span> <span class="nf">Item</span><span class="p">()</span>
     <span class="p">{</span>
          <span class="k">return</span> <span class="p">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">Magic</span> <span class="n">Cloak</span><span class="p">&amp;</span><span class="n">quot</span><span class="p">;;</span>
     <span class="p">}</span>
 <span class="p">}</span>

</code></pre>
</div>
<h2>Client</h2>
<p>Client is the last part is to create. Here we will create instance of the factory and spawn our enemies.</p>

<div class="language-c# highlighter-rouge"><pre class="highlight"><code>
<span class="k">class</span> <span class="nc">Client</span>
<span class="p">{</span>

<span class="n">IEnemyFactory</span> <span class="n">factory</span><span class="p">=</span><span class="k">null</span><span class="p">;</span>

<span class="c1">//SpawnEnemy method will decide what type of enemy will be created
</span>
<span class="c1">//Based on string input
</span>
<span class="k">public</span> <span class="k">void</span> <span class="nf">SpawnEnemy</span><span class="p">(</span><span class="kt">string</span> <span class="n">enemy</span><span class="p">)</span>
 <span class="p">{</span>
   <span class="k">if</span> <span class="p">(</span><span class="n">enemy</span> <span class="p">==</span> <span class="p">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">Warrior</span><span class="p">&amp;</span><span class="n">quot</span><span class="p">;)</span>
   <span class="p">{</span>
     <span class="n">factory</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Warrior</span><span class="p">();</span>
     <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">New</span> <span class="n">Warior</span> <span class="n">equipment</span><span class="p">:&amp;</span><span class="n">quot</span><span class="p">;);</span>
     <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">factory</span><span class="p">.</span><span class="nf">GetWeapon</span><span class="p">().</span><span class="nf">Item</span><span class="p">());</span>
     <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">factory</span><span class="p">.</span><span class="nf">GetArmor</span><span class="p">().</span><span class="nf">Item</span><span class="p">());</span>
     <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(&amp;</span><span class="n">amp</span><span class="p">;</span><span class="n">quot</span><span class="p">;</span><span class="n">_____________________</span><span class="p">&amp;</span><span class="n">amp</span><span class="p">;</span><span class="n">quot</span><span class="p">;);</span>
   <span class="p">}</span>
   <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">enemy</span> <span class="p">==</span> <span class="p">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">Mage</span><span class="p">&amp;</span><span class="n">quot</span><span class="p">;)</span>
   <span class="p">{</span>
     <span class="n">factory</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Mage</span><span class="p">();</span>
     <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">New</span> <span class="n">Mage</span> <span class="n">equipment</span><span class="p">:</span> <span class="p">&amp;</span><span class="n">quot</span><span class="p">;);</span>
     <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">factory</span><span class="p">.</span><span class="nf">GetWeapon</span><span class="p">().</span><span class="nf">Item</span><span class="p">());</span>
     <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">factory</span><span class="p">.</span><span class="nf">GetArmor</span><span class="p">().</span><span class="nf">Item</span><span class="p">());</span>
     <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">_____________________</span><span class="p">&amp;</span><span class="n">quot</span><span class="p">;);</span>
   <span class="p">}</span>
   <span class="k">else</span>
   <span class="p">{</span>
      <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">Wrong</span> <span class="n">type</span><span class="p">&amp;</span><span class="n">quot</span><span class="p">;);</span>
   <span class="p">}</span>
 <span class="p">}</span>

 <span class="c1">//Main method
</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
 <span class="p">{</span>
     <span class="n">Client</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Client</span><span class="p">();</span>
     <span class="n">client</span><span class="p">.</span><span class="nf">SpawnEnemy</span><span class="p">(&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">Mage</span><span class="p">&amp;</span><span class="n">quot</span><span class="p">;);</span>
     <span class="n">client</span><span class="p">.</span><span class="nf">SpawnEnemy</span><span class="p">(&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">Warrior</span><span class="p">&amp;</span><span class="n">quot</span><span class="p">;);</span>
     <span class="n">Console</span><span class="p">.</span><span class="nf">Read</span><span class="p">();</span>
 <span class="p">}</span>
<span class="p">}</span>

</code></pre>
</div>

<p>To conclude, Abstract Factory  provides an interface for creating families of related or dependent objects without specifying their concrete classes. This pattern is very useful but in large projects it may increase the complexity of the code. I hope you learned something new today. In next article You will learn how to implement another pattern. Stay Awesome!</p>

<p> </p>

  </section>
  
  <script>

</script>

</article>



      </div>

      <footer class="footer">
  <span class="footer__copyright">&copy; 2016 Jacek Rojek. All rights reserved.</span>
</footer> 

<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script type="text/javascript" src="/JacekRojek/js/main.js"></script>

    </div>
  </body>
</html>