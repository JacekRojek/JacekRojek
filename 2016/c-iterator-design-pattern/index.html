<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <title>C# Iterator Design Pattern</title>
  <meta name="description" content="Software development blog">
  <meta name="author" content="Jacek Rojek">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Jacek  Rojek">
  <meta name="twitter:description" content="Software development blog">

  <meta property="og:type" content="article">
  <meta property="og:title" content="Jacek  Rojek">
  <meta property="og:description" content="Software development blog">

  <link rel="apple-touch-icon" sizes="57x57" href="/JacekRojek/images/favicons/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/JacekRojek/images/favicons/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/JacekRojek/images/favicons/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/JacekRojek/images/favicons/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/JacekRojek/images/favicons/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/JacekRojek/images/favicons/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/JacekRojek/images/favicons/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/JacekRojek/images/favicons/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/JacekRojek/images/favicons/apple-touch-icon-180x180.png">
  <link rel="icon" type="image/png" href="/JacekRojek/images/favicons/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="/JacekRojek/images/favicons/favicon-194x194.png" sizes="194x194">
  <link rel="icon" type="image/png" href="/JacekRojek/images/favicons/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="/JacekRojek/images/favicons/android-chrome-192x192.png" sizes="192x192">
  <link rel="icon" type="image/png" href="/JacekRojek/images/favicons/favicon-16x16.png" sizes="16x16">
  <link rel="manifest" href="/JacekRojek/images/favicons/manifest.json">
  <link rel="shortcut icon" href="/JacekRojek/images/favicons/favicon.ico">
  <meta name="msapplication-TileColor" content="#ffc40d">
  <meta name="msapplication-TileImage" content="/JacekRojek/images/favicons/mstile-144x144.png">
  <meta name="theme-color" content="#ffffff">

  <link rel="stylesheet" href="/JacekRojek/css/main.css">
  <link rel="canonical" href="https://jacekrojek.github.io/JacekRojek//JacekRojek//2016/c-iterator-design-pattern/">
  <link rel="alternate" type="application/rss+xml" title="Jacek  Rojek" href="/JacekRojek/feed.xml">
</head>


  <body>
    <span class="mobile btn-mobile-menu">
  <i class="icon icon-list btn-mobile-menu__icon"></i>
  <i class="icon icon-x-circle btn-mobile-close__icon hidden"></i>
</span>
  
<header class="panel-cover" style="background-image: url(/JacekRojek/images/cover.jpg)">
  <div class="panel-main">

    <div class="panel-main__inner panel-inverted">
    <div class="panel-main__content">
        <a href="/JacekRojek/" title="link to home of Jacek  Rojek">
          <img src="/JacekRojek/images/profile.jpg" class="user-image" alt="My Profile Photo">
          <h1 class="panel-cover__title panel-title">Jacek  Rojek</h1>
        </a>
        <hr class="panel-cover__divider">
        <p class="panel-cover__description">Software development blog</p>
        <hr class="panel-cover__divider panel-cover__divider--secondary">

        <div class="navigation-wrapper">

          <nav class="cover-navigation cover-navigation--primary">
            <ul class="navigation">
              <li class="navigation__item"><a href="/JacekRojek/#blog" title="link to Jacek  Rojek blog" class="blog-button">Blog</a></li>
            </ul>
          </nav>

          <nav class="cover-navigation navigation--social">
            <ul class="navigation">
          
            
              <!-- Twitter -->
              <li class="navigation__item">
                <a href="http://twitter.com/JRojek93" title="@JRojek93 on Twitter" target="_blank">
                  <i class="icon icon-social-twitter"></i>
                  <span class="label">Twitter</span>
                </a>
              </li>
            

            
              <!-- Facebook -->
              <li class="navigation__item">
                <a href="http://fb.me/jacek.rojek.7" title="jacek.rojek.7 on Facebook" target="_blank">
                  <i class="icon icon-social-facebook"></i>
                  <span class="label">Facebook</span>
                </a>
              </li>
            

            
              <!-- LinkedIn -->
              <li class="navigation__item">
                <a href="https://www.linkedin.com/in/jacek-rojek-b7a396105" title="jacek-rojek-b7a396105 on LinkedIn" target="_blank">
                  <i class="icon icon-social-linkedin"></i>
                  <span class="label">LinkedIn</span>
                </a>
              </li>
            

            
              <!-- GitHub -->
              <li class="navigation__item">
                <a href="https://www.github.com/JacekRojek" title="JacekRojek on GitHub" target="_blank">
                  <i class="icon icon-social-github"></i>
                  <span class="label">GitHub</span>
                </a>
              </li>
            

            
              <!-- Email -->
              <li class="navigation__item">
                <a href="mailto:j.rojek19@gmail.com" title="Email j.rojek19@gmail.com" target="_blank">
                  <i class="icon icon-mail"></i>
                  <span class="label">Email</span>
                </a>
              </li>
            

            <!-- RSS -->
            <li class="navigation__item">
              <a href="/JacekRojek/feed.xml" title="Subscribe" target="_blank">
                <i class="icon icon-rss"></i>
                <span class="label">RSS</span>
              </a>
            </li>
          
            </ul>
          </nav>

        </div>

      </div>

    </div>

    <div class="panel-cover--overlay"></div>
  </div>
</header>


    <div class="content-wrapper">
      <div class="content-wrapper__inner">
        <article class="post-container post-container--single">
  <header class="post-header">
    <div class="post-meta">
      <time datetime="26 Jun 2016" class="post-meta__date date">26 Jun 2016</time> &#8226; <span class="post-meta__tags">on </span>
    </div>
    <h1 class="post-title">C# Iterator Design Pattern</h1>
  </header>

  <section class="post">
    <p><a href="http://pastebin.com/5Egf0puT">Link To source Code</a></p>

<p>This article will demonstrate the idea behind the Iteration pattern and simple implementation of it. The idea of the iterator pattern is to take the responsibility of accessing and passing trough the objects of the collection and put it in the iterator object. In C# Iterator pattern can be implemented simply using <a href="https://indiedevart.wordpress.com/2016/06/04/c-ienumerable-interface/">IEnumerable</a> interface. Implementation of IEnumerable interface allows you to syntax sugar like foreach loop. This leads to the topic of <a href="https://indiedevart.wordpress.com/2016/05/20/collections/">collections</a>.</p>

<p>In this post i’ll cover in more depth how Iterator is implemented by compiler. The iterator object will maintain the state of the iteration, keeping track of the current item and having a way of identifying what elements are next to be iterated. The abstraction provided by the iterator pattern allows you to modify the collection implementation without making any changes outside of collection.</p>

<p>This time you will see generic example of implementation, this is because i want to focus on the pattern functionality instead of  using techniques you may not know.</p>
<h3>UML diagram</h3>
<p><img class="alignnone size-full wp-image-3228" src="https://indiedevart.files.wordpress.com/2016/06/l6.png" alt="l6" width="658" height="462" /></p>

<p> </p>

<p>Let’s start by creating interface for IIterator. Iterator Interface defines an interface for accessing and traversing elements.</p>

<div class="language-c# highlighter-rouge"><pre class="highlight"><code><span class="k">interface</span> <span class="n">IIterator</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="n">FirstItem</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
  <span class="kt">int</span> <span class="n">NextItem</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
  <span class="kt">int</span> <span class="n">CurrentItem</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
  <span class="kt">bool</span> <span class="n">IsDone</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>This will simulate looping through the objects of collection.</p>

<p>Implementation of this interface will make the iteration process clearer.  Implementation of this patter can be more difficult to understand because each Class is referring to the next one. Iterator need to have a reference to the IAggregate to create instance of it in the constructor, and use it later for returning its values.</p>

<p>Return value is set to int in Aggregate for this example.</p>

<div class="language-c# highlighter-rouge"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Iterator</span> <span class="p">:</span> <span class="n">IIterator</span>
<span class="p">{</span>
  <span class="n">IAggregate</span> <span class="n">aggregate</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>

  <span class="c1">//We need an index to track the iteration process
</span>  <span class="kt">int</span> <span class="n">currentIndex</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>

  <span class="k">public</span> <span class="nf">Iterator</span><span class="p">(</span><span class="n">IAggregate</span> <span class="n">newAggregate</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">aggregate</span> <span class="p">=</span> <span class="n">newAggregate</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="c1">//Returns item with index 0
</span>  <span class="k">public</span> <span class="kt">int</span> <span class="n">FirstItem</span>
  <span class="p">{</span>
    <span class="k">get</span>
    <span class="p">{</span>
      <span class="n">currentIndex</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
      <span class="k">return</span> <span class="n">aggregate</span><span class="p">[</span><span class="n">currentIndex</span><span class="p">];</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="c1">//Returns next item
</span>  <span class="k">public</span> <span class="kt">int</span> <span class="n">NextItem</span>
  <span class="p">{</span>
   <span class="k">get</span>
   <span class="p">{</span>
     <span class="n">currentIndex</span> <span class="p">+=</span> <span class="m">1</span><span class="p">;</span>

     <span class="k">if</span> <span class="p">(</span><span class="n">IsDone</span> <span class="p">==</span> <span class="k">false</span><span class="p">)</span>
     <span class="p">{</span>
       <span class="k">return</span> <span class="n">aggregate</span><span class="p">[</span><span class="n">currentIndex</span><span class="p">];</span>
     <span class="p">}</span>
     <span class="k">else</span>
     <span class="p">{</span>
       <span class="k">return</span> <span class="p">-</span><span class="m">1</span><span class="p">;</span>
     <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="k">public</span> <span class="kt">int</span> <span class="n">CurrentItem</span>
  <span class="p">{</span>
    <span class="k">get</span>
    <span class="p">{</span>
       <span class="k">return</span> <span class="n">aggregate</span><span class="p">[</span><span class="n">currentIndex</span><span class="p">];</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="c1">//This method will give us feedabck when iteration ended
</span>  <span class="k">public</span> <span class="kt">bool</span> <span class="n">IsDone</span>
  <span class="p">{</span>
     <span class="k">get</span>
     <span class="p">{</span>
       <span class="k">if</span> <span class="p">(</span><span class="n">currentIndex</span> <span class="p">&amp;</span><span class="n">lt</span><span class="p">;</span> <span class="n">aggregate</span><span class="p">.</span><span class="n">Count</span><span class="p">)</span>
       <span class="p">{</span>
          <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
       <span class="p">}</span>
       <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
     <span class="p">}</span>
   <span class="p">}</span>
 <span class="p">}</span>
</code></pre>
</div>

<p> </p>

<p>Next interface to create is IAggregate.  One of the methods will return IIterator interface object.</p>

<div class="language-c# highlighter-rouge"><pre class="highlight"><code> <span class="k">interface</span> <span class="n">IAggregate</span>
 <span class="p">{</span>
   <span class="n">IIterator</span> <span class="nf">GetIterator</span><span class="p">();</span>
   <span class="c1">//This will handle manipulation of objects in the array
</span>   <span class="kt">int</span> <span class="k">this</span><span class="p">[</span><span class="kt">int</span> <span class="n">itemIndex</span><span class="p">]</span> <span class="p">{</span> <span class="k">set</span><span class="p">;</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
   <span class="kt">int</span> <span class="n">Count</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="p">}</span>
 <span class="p">}</span>
</code></pre>
</div>
<p>Implementation of this interface in Aggregate Class will be used as a place to create a list of an object that we will iterate through.</p>

<div class="language-c# highlighter-rouge"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Aggregate</span> <span class="p">:</span> <span class="n">IAggregate</span>
<span class="p">{</span>
  <span class="c1">//Here is why Iterator methods returns integers;
</span>  <span class="n">List</span><span class="p">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="kt">int</span><span class="p">&amp;</span><span class="n">gt</span><span class="p">;</span> <span class="n">values</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>

  <span class="k">public</span> <span class="nf">Aggregate</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="n">values</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="kt">int</span><span class="p">&amp;</span><span class="n">gt</span><span class="p">;();</span>
  <span class="p">}</span>

  <span class="k">public</span> <span class="n">IIterator</span> <span class="nf">GetIterator</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="c1">//Iterator constructor takes IAggregate as parameter
</span>    <span class="k">return</span> <span class="k">new</span> <span class="nf">Iterator</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">public</span> <span class="kt">int</span> <span class="k">this</span><span class="p">[</span><span class="kt">int</span> <span class="n">itemIndex</span><span class="p">]</span>
  <span class="p">{</span>
    <span class="k">get</span>
    <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">itemIndex</span> <span class="p">&amp;</span><span class="n">lt</span><span class="p">;</span> <span class="n">values</span><span class="p">.</span><span class="n">Count</span><span class="p">)</span>
       <span class="p">{</span>
           <span class="k">return</span> <span class="n">values</span><span class="p">[</span><span class="n">itemIndex</span><span class="p">];</span>
       <span class="p">}</span>
      <span class="k">else</span>
      <span class="p">{</span>
        <span class="k">return</span> <span class="p">-</span><span class="m">1</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">set</span>
    <span class="p">{</span>
        <span class="n">values</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="k">value</span><span class="p">);</span>
    <span class="p">}</span>
   <span class="p">}</span>

   <span class="k">public</span> <span class="kt">int</span> <span class="n">Count</span>
   <span class="p">{</span>
     <span class="k">get</span>
     <span class="p">{</span>
       <span class="k">return</span> <span class="n">values</span><span class="p">.</span><span class="n">Count</span><span class="p">;</span>
     <span class="p">}</span>
   <span class="p">}</span>
 <span class="p">}</span>
</code></pre>
</div>

<p> </p>

<p>Last step is to create a Client that will create instance of Aggregate Class and Use Iterator to loop throug collection items.</p>

<div class="language-c# highlighter-rouge"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Program</span>
<span class="p">{</span>
  <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
  <span class="p">{</span>
    <span class="n">Aggregate</span> <span class="n">aggr</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Aggregate</span><span class="p">();</span>

    <span class="n">aggr</span><span class="p">[</span><span class="m">0</span><span class="p">]</span> <span class="p">=</span> <span class="m">7</span><span class="p">;</span>
    <span class="n">aggr</span><span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="p">=</span> <span class="m">8</span><span class="p">;</span>
    <span class="n">aggr</span><span class="p">[</span><span class="m">2</span><span class="p">]</span> <span class="p">=</span> <span class="m">9</span><span class="p">;</span>
    <span class="n">aggr</span><span class="p">[</span><span class="m">3</span><span class="p">]</span> <span class="p">=</span> <span class="m">89</span><span class="p">;</span>

  <span class="n">IIterator</span> <span class="n">iter</span> <span class="p">=</span> <span class="n">aggr</span><span class="p">.</span><span class="nf">GetIterator</span><span class="p">();</span>
  <span class="c1">//Loops until isDone==false
</span>    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="n">iter</span><span class="p">.</span><span class="n">FirstItem</span><span class="p">;</span> <span class="n">iter</span><span class="p">.</span><span class="n">IsDone</span> <span class="p">==</span> <span class="k">false</span><span class="p">;</span> <span class="n">i</span> <span class="p">=</span> <span class="n">iter</span><span class="p">.</span><span class="n">NextItem</span><span class="p">)</span>
    <span class="p">{</span>
       <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">i</span><span class="p">.</span><span class="nf">ToString</span><span class="p">());</span>
    <span class="p">}</span>
  <span class="n">Console</span><span class="p">.</span><span class="nf">ReadLine</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>
<p>To conclude, Iteration pattern provides a way to access the elements of an aggregate object sequentially without exposing its underlying representation. In C# this can be handled just by implementing IEnumerable interface. I hope you learned something new today. In Next article I’ll cover one last design patterns. Stay Awesome!</p>

<p>PS: Thanks for all Up votes On <a href="https://www.reddit.com/">Reddit.com</a>! I can’t reply to  comments, because of shadow-ban :D</p>

  </section>
  
  <script>

</script>

</article>



      </div>

      <footer class="footer">
  <span class="footer__copyright">&copy; 2016 Jacek Rojek. All rights reserved.</span>
</footer> 

<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script type="text/javascript" src="/JacekRojek/js/main.js"></script>

    </div>
  </body>
</html>