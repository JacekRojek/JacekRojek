<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <title>C# Command Design Pattern</title>
  <meta name="description" content="Software development blog">
  <meta name="author" content="Jacek Rojek">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="JacekRojek">
  <meta name="twitter:description" content="Software development blog">

  <meta property="og:type" content="article">
  <meta property="og:title" content="JacekRojek">
  <meta property="og:description" content="Software development blog">

  <link rel="apple-touch-icon" sizes="57x57" href="/JacekRojek/images/favicons/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/JacekRojek/images/favicons/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/JacekRojek/images/favicons/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/JacekRojek/images/favicons/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/JacekRojek/images/favicons/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/JacekRojek/images/favicons/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/JacekRojek/images/favicons/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/JacekRojek/images/favicons/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/JacekRojek/images/favicons/apple-touch-icon-180x180.png">
  <link rel="icon" type="image/png" href="/JacekRojek/images/favicons/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="/JacekRojek/images/favicons/favicon-194x194.png" sizes="194x194">
  <link rel="icon" type="image/png" href="/JacekRojek/images/favicons/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="/JacekRojek/images/favicons/android-chrome-192x192.png" sizes="192x192">
  <link rel="icon" type="image/png" href="/JacekRojek/images/favicons/favicon-16x16.png" sizes="16x16">
  <link rel="manifest" href="/JacekRojek/images/favicons/manifest.json">
  <link rel="shortcut icon" href="/JacekRojek/images/favicons/favicon.ico">
  <meta name="msapplication-TileColor" content="#ffc40d">
  <meta name="msapplication-TileImage" content="/JacekRojek/images/favicons/mstile-144x144.png">
  <meta name="theme-color" content="#ffffff">

  <link rel="stylesheet" href="/JacekRojek/css/main.css">
  <link rel="canonical" href="https://jacekrojek.github.io/JacekRojek//JacekRojek//2016/c-command-design-pattern/">
  <link rel="alternate" type="application/rss+xml" title="JacekRojek" href="/JacekRojek/feed.xml">
</head>


  <body>
    <span class="mobile btn-mobile-menu">
  <i class="icon icon-list btn-mobile-menu__icon"></i>
  <i class="icon icon-x-circle btn-mobile-close__icon hidden"></i>
</span>
  
<header class="panel-cover" style="background-image: url(/JacekRojek/images/cover.jpg)">
  <div class="panel-main">

    <div class="panel-main__inner panel-inverted">
    <div class="panel-main__content">
        <a href="/JacekRojek/" title="link to home of JacekRojek">
          <img src="/JacekRojek/images/profile.jpg" class="user-image" alt="My Profile Photo">
          <h1 class="panel-cover__title panel-title">JacekRojek</h1>
        </a>
        <hr class="panel-cover__divider">
        <p class="panel-cover__description">Software development blog</p>
        <hr class="panel-cover__divider panel-cover__divider--secondary">

        <div class="navigation-wrapper">

          <nav class="cover-navigation cover-navigation--primary">
            <ul class="navigation">
              <li class="navigation__item"><a href="/JacekRojek/#blog" title="link to JacekRojek blog" class="blog-button">Blog</a></li>
            </ul>
          </nav>

          <nav class="cover-navigation navigation--social">
            <ul class="navigation">
          
            
              <!-- Twitter -->
              <li class="navigation__item">
                <a href="http://twitter.com/JRojek93" title="@JRojek93 on Twitter" target="_blank">
                  <i class="icon icon-social-twitter"></i>
                  <span class="label">Twitter</span>
                </a>
              </li>
            

            
              <!-- Facebook -->
              <li class="navigation__item">
                <a href="http://fb.me/jacek.rojek.7" title="jacek.rojek.7 on Facebook" target="_blank">
                  <i class="icon icon-social-facebook"></i>
                  <span class="label">Facebook</span>
                </a>
              </li>
            

            
              <!-- LinkedIn -->
              <li class="navigation__item">
                <a href="https://www.linkedin.com/in/jacek-rojek-b7a396105" title="jacek-rojek-b7a396105 on LinkedIn" target="_blank">
                  <i class="icon icon-social-linkedin"></i>
                  <span class="label">LinkedIn</span>
                </a>
              </li>
            

            
              <!-- GitHub -->
              <li class="navigation__item">
                <a href="https://www.github.com/JacekRojek" title="JacekRojek on GitHub" target="_blank">
                  <i class="icon icon-social-github"></i>
                  <span class="label">GitHub</span>
                </a>
              </li>
            

            
              <!-- Email -->
              <li class="navigation__item">
                <a href="mailto:j.rojek19@gmail.com" title="Email j.rojek19@gmail.com" target="_blank">
                  <i class="icon icon-mail"></i>
                  <span class="label">Email</span>
                </a>
              </li>
            

            <!-- RSS -->
            <li class="navigation__item">
              <a href="/JacekRojek/feed.xml" title="Subscribe" target="_blank">
                <i class="icon icon-rss"></i>
                <span class="label">RSS</span>
              </a>
            </li>
          
            </ul>
          </nav>

        </div>

      </div>

    </div>

    <div class="panel-cover--overlay"></div>
  </div>
</header>


    <div class="content-wrapper">
      <div class="content-wrapper__inner">
        <article class="post-container post-container--single">
  <header class="post-header">
    <div class="post-meta">
      <time datetime="27 Jun 2016" class="post-meta__date date">27 Jun 2016</time> &#8226; <span class="post-meta__tags">on </span>
    </div>
    <h1 class="post-title">C# Command Design Pattern</h1>
  </header>

  <section class="post">
    <p><a href="http://pastebin.com/hY1QsCud">Link to Source Code</a></p>

<p>Command pattern allows you to store list of code that is executed many times or at a later time. It also gives you easy way to implement Undo() that can just have opposite effect or undo multiple command, if commands are stored in list. This pattern is supports encapsulation, which is always a good thing. It may look complicated, it involves multiple classes:</p>

<p><strong> Receiver -</strong> that performs the Action associated with the request.</p>

<p><strong>Invoker  -</strong>that<strong> </strong>asks the command to carry out the request</p>

<p><strong>Command</strong> -this is an interface which specifies the Execute and/or Undo operation.</p>

<p><strong>Client</strong> - creates instance of an invoker, command and receiver and connects them.</p>

<p>As usual I’ll be using example related to video games. In my example I created simulation where Enemy can enter the field on the battlefield that can Heal him or it can add a Buff. I have two types of enemies Goblin and dragon, just to demonstrate the example of multiple receivers. When enemy exits the field the opposite action is triggered.</p>

<p> </p>
<h3>UML Diagram</h3>
<p><img class="alignnone size-full wp-image-3320" src="https://indiedevart.files.wordpress.com/2016/06/l7.png" alt="l7" width="995" height="617" /></p>
<h2>Receiver</h2>
<p>Lets start by creating interface for Enemies. Every enemy that implements this interface can either take damage, heal, and Turn Buff OFF and ON.</p>

<p>[code language=”csharp”]</p>

<p>interface IEnemy
{
  string Damage();
  string Heal();
  string BuffON();
  string BuffOFF();
}[/code]</p>

<p>Each method will return a string with massage about current status.</p>

<p>Here is implementation of the interface in one of the Enemy Class. Second One is very similar and you can find it in source code.</p>

<p>[code language=”csharp”]</p>

<p>class Goblin : IEnemy
{
  public string BuffOFF()
  {
    return "Goblin enters the field-Buff is ON";
  }</p>

<p>public string BuffON()
  {
    return "Goblin exits the field-Buff is OFF";
  }</p>

<p>public string Damage()
  {
    return "Goblin exits the field- takes damage";
  }</p>

<p>public string Heal()
  {
     return "Goblin enters the field- heals";
  }</p>

<p>[/code]</p>
<h2>Command</h2>
<p>This interface will specify how retriever will respond to execute()and undo() commands.</p>

<p>[code language=”csharp”]
interface ICommand
{
  void Execute();
  void UnDo();
} [/code]</p>

<p>implementation of this interface requires a instance of an IEnemy receiver, in class constructor we pass the receiver that will be manipulated by the command. Again I’m showing here just one of two Classes, because both are identical.</p>

<p>[code language=”csharp”]</p>

<p>class Heal : ICommand
{
  IEnemy _receiver;
  // Constructor
  public Heal(IEnemy receiver)
  {
    _receiver = receiver;
  }</p>

<p>public void Execute()
  {
    Console.WriteLine(_receiver.Heal());
  }
  public void UnDo()
  {
    Console.WriteLine(_receiver.Damage());
  }
}
[/code]</p>

<p> </p>
<h2>Invoker</h2>
<p>In my example i’m simulating situation when enemy enters the field on the map, that triggers the commands. In the invoker we pass instance of command that we want to execute.</p>

<p>[code language=”csharp”]</p>

<p>class Field
{
  private ICommand _command;</p>

<p>public void SetCommand(ICommand command)
  {
    this._command = command;
  }</p>

<p>public void EnterField()
  {
  _command.Execute();
  }
  public void ExitField()
  {
  _command.UnDo();
  }
}</p>

<p>[/code]</p>
<h2>Client</h2>
<p>This is the last part of the program that connect everything together. In this specific example I chose the situation when Enemy Goblin Enters the Field, what trigger the Heal command. After leaving the field Goblin Takes Damage.</p>

<p>[code language=”csharp”]</p>

<p>static void Main()
{
  // Create receiver, command, and invoker
  IEnemy receiver = new Goblin();
  ICommand command = new Heal(receiver);
  Field invoker = new Field();</p>

<p>// Set and execute command
  invoker.SetCommand(command);
  invoker.EnterField();
  invoker.ExitField();</p>

<p>Console.ReadKey();
}[/code]</p>

<p>This was just a simple demonstration of the pattern, one way of extending the functionality of it is to store command in the generic list, this way we can undo multiple commands or execute command already executed in the past. I hope you like will find it useful. In my next article I’ll cover on of the last design patters. Stay Awesome!</p>

  </section>
  
</article>



      </div>

      <footer class="footer">
  <span class="footer__copyright">&copy; 2016 Jacek Rojek. All rights reserved.</span>
</footer> 

<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script type="text/javascript" src="/JacekRojek/js/main.js"></script>

    </div>
  </body>
</html>