<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <title>Unity Achievements System Tutorial</title>
  <meta name="description" content="Software development blog">
  <meta name="author" content="Jacek Rojek">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Jacek  Rojek">
  <meta name="twitter:description" content="Software development blog">

  <meta property="og:type" content="article">
  <meta property="og:title" content="Jacek  Rojek">
  <meta property="og:description" content="Software development blog">

  <link rel="apple-touch-icon" sizes="57x57" href="/JacekRojek/images/favicons/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/JacekRojek/images/favicons/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/JacekRojek/images/favicons/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/JacekRojek/images/favicons/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/JacekRojek/images/favicons/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/JacekRojek/images/favicons/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/JacekRojek/images/favicons/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/JacekRojek/images/favicons/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/JacekRojek/images/favicons/apple-touch-icon-180x180.png">
  <link rel="icon" type="image/png" href="/JacekRojek/images/favicons/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="/JacekRojek/images/favicons/favicon-194x194.png" sizes="194x194">
  <link rel="icon" type="image/png" href="/JacekRojek/images/favicons/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="/JacekRojek/images/favicons/android-chrome-192x192.png" sizes="192x192">
  <link rel="icon" type="image/png" href="/JacekRojek/images/favicons/favicon-16x16.png" sizes="16x16">
  <link rel="manifest" href="/JacekRojek/images/favicons/manifest.json">
  <link rel="shortcut icon" href="/JacekRojek/images/favicons/favicon.ico">
  <meta name="msapplication-TileColor" content="#ffc40d">
  <meta name="msapplication-TileImage" content="/JacekRojek/images/favicons/mstile-144x144.png">
  <meta name="theme-color" content="#ffffff">

  <link rel="stylesheet" href="/JacekRojek/css/main.css">
  <link rel="canonical" href="https://jacekrojek.github.io/JacekRojek//JacekRojek//2016/achievements-system/">
  <link rel="alternate" type="application/rss+xml" title="Jacek  Rojek" href="/JacekRojek/feed.xml">
</head>


  <body>
    <span class="mobile btn-mobile-menu">
  <i class="icon icon-list btn-mobile-menu__icon"></i>
  <i class="icon icon-x-circle btn-mobile-close__icon hidden"></i>
</span>
  
<header class="panel-cover" style="background-image: url(/JacekRojek/images/cover.jpg)">
  <div class="panel-main">

    <div class="panel-main__inner panel-inverted">
    <div class="panel-main__content">
        <a href="/JacekRojek/" title="link to home of Jacek  Rojek">
          <img src="/JacekRojek/images/profile.jpg" class="user-image" alt="My Profile Photo">
          <h1 class="panel-cover__title panel-title">Jacek  Rojek</h1>
        </a>
        <hr class="panel-cover__divider">
        <p class="panel-cover__description">Software development blog</p>
        <hr class="panel-cover__divider panel-cover__divider--secondary">

        <div class="navigation-wrapper">

          <nav class="cover-navigation cover-navigation--primary">
            <ul class="navigation">
              <li class="navigation__item"><a href="/JacekRojek/#blog" title="link to Jacek  Rojek blog" class="blog-button">Blog</a></li>
            </ul>
          </nav>

          <nav class="cover-navigation navigation--social">
            <ul class="navigation">
          
            
              <!-- Twitter -->
              <li class="navigation__item">
                <a href="http://twitter.com/JRojek93" title="@JRojek93 on Twitter" target="_blank">
                  <i class="icon icon-social-twitter"></i>
                  <span class="label">Twitter</span>
                </a>
              </li>
            

            
              <!-- Facebook -->
              <li class="navigation__item">
                <a href="http://fb.me/jacek.rojek.7" title="jacek.rojek.7 on Facebook" target="_blank">
                  <i class="icon icon-social-facebook"></i>
                  <span class="label">Facebook</span>
                </a>
              </li>
            

            
              <!-- LinkedIn -->
              <li class="navigation__item">
                <a href="https://www.linkedin.com/in/jacek-rojek-b7a396105" title="jacek-rojek-b7a396105 on LinkedIn" target="_blank">
                  <i class="icon icon-social-linkedin"></i>
                  <span class="label">LinkedIn</span>
                </a>
              </li>
            

            
              <!-- GitHub -->
              <li class="navigation__item">
                <a href="https://www.github.com/JacekRojek" title="JacekRojek on GitHub" target="_blank">
                  <i class="icon icon-social-github"></i>
                  <span class="label">GitHub</span>
                </a>
              </li>
            

            
              <!-- Email -->
              <li class="navigation__item">
                <a href="mailto:j.rojek19@gmail.com" title="Email j.rojek19@gmail.com" target="_blank">
                  <i class="icon icon-mail"></i>
                  <span class="label">Email</span>
                </a>
              </li>
            

            <!-- RSS -->
            <li class="navigation__item">
              <a href="/JacekRojek/feed.xml" title="Subscribe" target="_blank">
                <i class="icon icon-rss"></i>
                <span class="label">RSS</span>
              </a>
            </li>
          
            </ul>
          </nav>

        </div>

      </div>

    </div>

    <div class="panel-cover--overlay"></div>
  </div>
</header>


    <div class="content-wrapper">
      <div class="content-wrapper__inner">
        <article class="post-container post-container--single">
  <header class="post-header">
    <div class="post-meta">
      <time datetime="8 Jun 2016" class="post-meta__date date">8 Jun 2016</time> &#8226; <span class="post-meta__tags">on </span>
    </div>
    <h1 class="post-title">Unity Achievements System Tutorial</h1>
  </header>

  <section class="post">
    <p>In this series of tutorials I will demonstrate how to create a modularized system of achievements. In this part I will show you how to use <a href="https://indiedevart.wordpress.com/2016/06/05/unity-coroutines/">Coroutines</a> to create linear movement and wait method. For messaging  between object I’ll use <a href="https://indiedevart.wordpress.com/2016/06/07/unity-eventmanager/">EventManager</a>. You can read more about those topics if you are not familiar with it.</p>

<p> </p>

<p>[caption id=”attachment_2197” align=”alignleft” width=”365”]<img class="alignnone  wp-image-2197" src="https://indiedevart.files.wordpress.com/2016/06/tutorial02.gif?w=1024" alt="Tutorial02" width="365" height="243" /> Achievement Unlocked![/caption]</p>

<p>In first lesson I will demonstrate the basic structure of the system using pre made achievement panel, in next you will learn how to read data from files to set the text and images for individual achievements.</p>

<p>To unlock this achievement player must click button 10 times.</p>

<p> </p>

<p> </p>

<p>First lets create an Event Manager for passing messages between button and Achievement panel. I described process of creating this in previous post, <a href="https://indiedevart.wordpress.com/2016/06/07/unity-eventmanager/">here</a>.</p>

<div class="language-c# highlighter-rouge"><pre class="highlight"><code><span class="k">using</span> <span class="nn">UnityEngine</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">UnityEngine.Events</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>

<span class="k">public</span> <span class="k">class</span> <span class="nc">EventManager</span> <span class="p">:</span> <span class="n">MonoBehaviour</span> <span class="p">{</span>
<span class="k">private</span> <span class="n">Dictionary</span><span class="p">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="kt">string</span><span class="p">,</span> <span class="n">UnityEvent</span><span class="p">&amp;</span><span class="n">gt</span><span class="p">;</span> <span class="n">eventDictionary</span><span class="p">;</span>
<span class="k">private</span> <span class="k">static</span> <span class="n">EventManager</span> <span class="n">eventManager</span><span class="p">;</span>
<span class="k">public</span> <span class="k">static</span> <span class="n">EventManager</span> <span class="n">instance</span>
<span class="p">{</span>
  <span class="k">get</span>
  <span class="p">{</span>
     <span class="k">if</span> <span class="p">(!</span><span class="n">eventManager</span><span class="p">)</span>
     <span class="p">{</span>
         <span class="n">eventManager</span> <span class="p">=</span> <span class="nf">FindObjectOfType</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">EventManager</span><span class="p">))</span> <span class="k">as</span> <span class="n">EventManager</span><span class="p">;</span>
         <span class="n">eventManager</span><span class="p">.</span><span class="nf">Init</span><span class="p">();</span>
     <span class="p">}</span>
     <span class="k">return</span> <span class="n">eventManager</span><span class="p">;</span>
   <span class="p">}</span>
 <span class="p">}</span>

 <span class="k">void</span> <span class="nf">Init</span><span class="p">()</span>
 <span class="p">{</span>
     <span class="n">eventDictionary</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Dictionary</span><span class="p">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="kt">string</span><span class="p">,</span> <span class="n">UnityEvent</span><span class="p">&amp;</span><span class="n">gt</span><span class="p">;();</span>
 <span class="p">}</span>

 <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">StartListening</span><span class="p">(</span><span class="kt">string</span> <span class="n">eventName</span><span class="p">,</span> <span class="n">UnityAction</span> <span class="n">listener</span><span class="p">)</span>
 <span class="p">{</span>
   <span class="c1">//We need to crate place in memory for reference to the object
</span>   <span class="n">UnityEvent</span> <span class="n">thisEvent</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
   <span class="k">if</span> <span class="p">(</span><span class="n">instance</span><span class="p">.</span><span class="n">eventDictionary</span><span class="p">.</span><span class="nf">TryGetValue</span><span class="p">(</span><span class="n">eventName</span><span class="p">,</span> <span class="k">out</span> <span class="n">thisEvent</span><span class="p">))</span>
   <span class="p">{</span>
       <span class="n">thisEvent</span><span class="p">.</span><span class="nf">AddListener</span><span class="p">(</span><span class="n">listener</span><span class="p">);</span>
   <span class="p">}</span>
   <span class="k">else</span>
   <span class="p">{</span>
     <span class="c1">//If there is no event with this name add new one to dictionary.
</span>      <span class="n">thisEvent</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">UnityEvent</span><span class="p">();</span>
      <span class="n">thisEvent</span><span class="p">.</span><span class="nf">AddListener</span><span class="p">(</span><span class="n">listener</span><span class="p">);</span>
      <span class="n">instance</span><span class="p">.</span><span class="n">eventDictionary</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">eventName</span><span class="p">,</span> <span class="n">thisEvent</span><span class="p">);</span>
   <span class="p">}</span>
 <span class="p">}</span>

 <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">StopListening</span><span class="p">(</span><span class="kt">string</span> <span class="n">eventName</span><span class="p">,</span> <span class="n">UnityAction</span> <span class="n">listener</span><span class="p">)</span>
 <span class="p">{</span>
   <span class="n">UnityEvent</span> <span class="n">thisEvent</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
   <span class="k">if</span> <span class="p">(</span><span class="n">instance</span><span class="p">.</span><span class="n">eventDictionary</span><span class="p">.</span><span class="nf">TryGetValue</span><span class="p">(</span><span class="n">eventName</span><span class="p">,</span> <span class="k">out</span> <span class="n">thisEvent</span><span class="p">))</span>
   <span class="p">{</span>
      <span class="n">thisEvent</span><span class="p">.</span><span class="nf">RemoveListener</span><span class="p">(</span><span class="n">listener</span><span class="p">);</span>
   <span class="p">}</span>
 <span class="p">}</span>

 <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">TriggerEvent</span><span class="p">(</span><span class="kt">string</span> <span class="n">eventName</span><span class="p">)</span>
 <span class="p">{</span>
   <span class="n">UnityEvent</span> <span class="n">thisEvent</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
   <span class="k">if</span> <span class="p">(</span><span class="n">instance</span><span class="p">.</span><span class="n">eventDictionary</span><span class="p">.</span><span class="nf">TryGetValue</span><span class="p">(</span><span class="n">eventName</span><span class="p">,</span> <span class="k">out</span> <span class="n">thisEvent</span><span class="p">))</span>
   <span class="p">{</span>
       <span class="n">thisEvent</span><span class="p">.</span><span class="nf">Invoke</span><span class="p">();</span>
   <span class="p">}</span>
 <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>This script is attached to an empty game object called Event Manager. Now we will create an action of clicking a button and subscribe counting method to it.</p>

<p>This Script is attached to UI Button, in this Script we trigger our event and also display the number of clicks an the scene.
~~~ c#<br />
using UnityEngine;
using UnityEngine.UI;
using System.Collections;
using UnityEngine.EventSystems;
public class TESTClick : MonoBehaviour, IPointerDownHandler
{
 int numberofClicks=0;
 public void OnPointerDown(PointerEventData eventData)
 {
   numberofClicks++;
   EventManager.TriggerEvent("buttonClicked");
   this.GetComponentInChildren&amp;lt;Text&amp;gt;().text = numberofClicks.ToString();
 }
}~~~</p>

<p>I’m using OnPointerDown() method to trigger the event. This method is called when player clicks the button, To use it you need to add  IPointerDownHandler <a href="https://indiedevart.wordpress.com/2016/05/27/interfaces/">Interface</a>. and <a href="https://indiedevart.wordpress.com/2016/05/15/events/">EventSystem</a> to your script.</p>

<p>Now we finally have Script attached to Panel Game Object.
~~~ c#<br />
using UnityEngine;
using System.Collections;</p>

<p>public class AchievementPanle : MonoBehaviour {</p>

<p>private GameObject panelAchievements;
 private int numberOfClicks=0;
 float lerpTime = 3f;
 float currentLerpTime = 0f;
 Vector3 startpPos = new Vector3(425, -470, 0);
 Vector3 endPos = new Vector3(425, -315, 0);
//
 private bool achievement01Unlocked=false;</p>

<p>void OnEnable()
 {
   panelAchievements = this.gameObject;
   EventManager.StartListening("buttonClicked", CountClicks);
 }
 void OnDisable()
 {
     EventManager.StopListening("buttonClicked", CountClicks);
 }
 void CountClicks()
 {
   numberOfClicks++;
   if (numberOfClicks &amp;gt;= 10 &amp;amp;&amp;amp; !achievement01Unlocked)
   {
     StartCoroutine(PanelCall());
     achievement01Unlocked = true;
   }
 }</p>

<p>private IEnumerator PanelCall()
 {
  float perc = currentLerpTime / lerpTime;
  panelAchievements.SetActive(true);
  while (currentLerpTime &amp;lt; lerpTime)
  {
     currentLerpTime += Time.deltaTime;
     perc = currentLerpTime / lerpTime;
     panelAchievements.transform.localPosition = Vector3.Lerp(startpPos, endPos, perc);
     yield return true;
  }
  yield return new WaitForSeconds(2);
  panelAchievements.SetActive(false);
  panelAchievements.transform.localPosition = startpPos;
 }
}
~~~ 
In this script we subscribe to the “buttonClicked” Action, And we use Coroutine to initialize panel movement without using Update() Method. Linear transition is described in detains in my previous post, <a href="https://indiedevart.wordpress.com/2016/06/06/unity-linear-interpolation/">here</a>. In this example I have fixed start and end position which will be changed later.</p>

<p>This method works well for one achievement, but to use more of them in efficient way we need to upgrade the code. In next Part I’ll show you how to read the JSON files to change the text and image an the achievement panel. In future article I’ll show you how to create separate scene for achievements where all achievements will be stored, and unlocked achievements will be highlighted after unlocking. To do this I’ll use Dictionary and List collections. If you have any questions ask in comments or message me on <a href="https://www.facebook.com/jacek.rojek.7">Facebook</a>. Stay Awesome!</p>

<p> </p>

<p> </p>

<p> </p>

  </section>
  
  <script>

</script>

</article>



      </div>

      <footer class="footer">
  <span class="footer__copyright">&copy; 2016 Jacek Rojek. All rights reserved.</span>
</footer> 

<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script type="text/javascript" src="/JacekRojek/js/main.js"></script>

    </div>
  </body>
</html>